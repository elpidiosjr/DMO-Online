<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Minha Conta - Digimon</title>

<style>
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:#071022;
  color:#fff;
  padding:18px;
}

a{color:#fff;text-decoration:none}

.container{
  max-width:900px;
  margin:0 auto;
}

.card{
  background:linear-gradient(180deg,#0b1633,#071022);
  padding:14px;
  border-radius:14px;
  margin-bottom:14px;
  display:flex;
  gap:16px;
  align-items:center;
  box-shadow:0 10px 25px rgba(0,0,0,.35);
}

.card img{
  width:90px;
  height:90px;
  object-fit:contain;
  background:#fff;
  padding:6px;
  border-radius:10px;
}

.info{
  flex:1;
}

.name{
  font-weight:800;
  font-size:1.2rem;
}

.stat{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:6px;
  font-size:.9rem;
}

.bar{
  flex:1;
  height:10px;
  background:#1e293b;
  border-radius:999px;
  overflow:hidden;
}

.fill{
  height:100%;
  width:0;
  transition:width .6s ease;
}

.atk{background:#ef4444}
.def{background:#3b82f6}
.esp{background:#facc15}

.actions{
  display:flex;
  flex-direction:column;
  gap:8px;
}

button{
  border:none;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
  font-weight:700;
}

.train{background:#06b6d4}
.battle{background:#16a34a}
.remove{background:#ef4444}

.pagination{
  display:flex;
  justify-content:center;
  gap:12px;
  margin-top:18px;
}

.pagination button{
  background:#1e293b;
  color:#fff;
}
</style>
</head>

<body>

<div class="container">
  <a href="index.html">‚Üê Voltar</a>

  <h1>Meu Time</h1>
  <p style="color:#94a3b8">Escolha um Digimon para batalhar contra um oponente aleat√≥rio</p>

  <div id="list">Carregando...</div>

  <div class="pagination">
    <button id="prev">‚óÄ Anterior</button>
    <button id="next">Pr√≥xima ‚ñ∂</button>
  </div>
</div>

<script>
const API_URL = 'https://digimon-api.vercel.app/api/digimon';
const PER_PAGE = 3;
let page = 0;
let apiCache = [];

function getMap(){
  try{
    return JSON.parse(localStorage.getItem('digimon_stats_v1'))||{};
  }catch{
    return {};
  }
}

async function loadAPI(){
  if(apiCache.length) return apiCache;
  const res = await fetch(API_URL);
  apiCache = await res.json();
  return apiCache;
}

async function render(){
  const list = document.getElementById('list');
  const map = getMap();
  const names = Object.keys(map);

  if(!names.length){
    list.innerHTML='<p style="color:#94a3b8">Nenhum Digimon treinado.</p>';
    return;
  }

  const api = await loadAPI();
  list.innerHTML='';

  const start = page * PER_PAGE;
  const slice = names.slice(start,start+PER_PAGE);

  slice.forEach(name=>{
    const s = map[name];
    const dig = api.find(d=>d.name.toLowerCase()===name.toLowerCase());

    const card = document.createElement('div');
    card.className='card';

    card.innerHTML=`
      <img src="${dig?.img||''}">
      <div class="info">
        <div class="name">${name}</div>

        <div class="stat">
          ‚öîÔ∏è <div class="bar"><div class="fill atk" style="width:${s.atk}%"></div></div>
        </div>

        <div class="stat">
          üõ°Ô∏è <div class="bar"><div class="fill def" style="width:${s.def}%"></div></div>
        </div>

        <div class="stat">
          ‚ú® <div class="bar"><div class="fill esp" style="width:${s.esp}%"></div></div>
        </div>
      </div>

      <div class="actions">
        <a href="train.html?name=${encodeURIComponent(name)}">
          <button class="train">Treinar</button>
        </a>

        <a href="battle.html?name=${encodeURIComponent(name)}">
          <button class="battle">Batalhar</button>
        </a>

        <button class="remove" data-name="${name}">Remover</button>
      </div>
    `;

    list.appendChild(card);
  });

  document.querySelectorAll('.remove').forEach(b=>{
    b.onclick=()=>{
      const map = getMap();
      delete map[b.dataset.name];
      localStorage.setItem('digimon_stats_v1',JSON.stringify(map));
      render();
    };
  });

  document.getElementById('prev').disabled = page===0;
  document.getElementById('next').disabled = start+PER_PAGE >= names.length;
}

document.getElementById('prev').onclick=()=>{page--;render();};
document.getElementById('next').onclick=()=>{page++;render();};

render();
</script>

</body>
</html>
